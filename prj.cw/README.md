# Shadow Segmentation Application

Это приложение на C++ для сегментации теней на изображениях с использованием OpenCV и Qt.

## Возможности

- Загрузка изображений в различных форматах (PNG, JPG, JPEG, BMP, TIFF)
- Интерактивная настройка параметров HSV для детекции теней
- Визуализация результатов с выделением теней красным цветом
- Простой и интуитивный графический интерфейс

## Требования

### Системные требования:
- C++14 или выше
- CMake 3.10 или выше
- OpenCV 4.x
- Qt5 (модуль Widgets)

### Установка зависимостей:

#### Ubuntu/Debian:
```bash
sudo apt update
sudo apt install build-essential cmake
sudo apt install libopencv-dev
sudo apt install qtbase5-dev qttools5-dev
```

#### CentOS/RHEL/Fedora:
```bash
sudo yum install gcc-c++ cmake
sudo yum install opencv-devel
sudo yum install qt5-qtbase-devel
```

#### Windows:
1. Установите Visual Studio с поддержкой C++
2. Скачайте и установите OpenCV с официального сайта
3. Скачайте и установите Qt5 с официального сайта
4. Настройте переменные окружения для OpenCV и Qt

#### macOS:
```bash
brew install cmake opencv qt5
```

## Сборка проекта

### Linux/macOS:
```bash
chmod +x build.sh
./build.sh
```

### Windows:
```batch
build.bat
```

### Ручная сборка:
```bash
mkdir build
cd build
cmake ..
make  # или cmake --build . для Windows
```

## Запуск приложения

После успешной сборки:

### Linux/macOS:
```bash
cd build
./ShadowSegmentation
```

### Windows:
```batch
cd build
ShadowSegmentation.exe
```

## Использование

1. **Загрузка изображения**: Нажмите кнопку "Load Image" и выберите изображение
2. **Настройка параметров**: Используйте слайдеры для настройки HSV порогов:
   - Hue (Оттенок): 0-179
   - Saturation (Насыщенность): 0-255  
   - Value (Яркость): 0-255
3. **Обработка**: Результат обновляется автоматически при изменении параметров
4. **Анализ результата**: Тени выделяются красным цветом на исходном изображении

## Алгоритм сегментации теней

Приложение использует следующий подход для детекции теней:

1. **Преобразование в HSV**: Исходное изображение конвертируется в цветовое пространство HSV
2. **Пороговая обработка**: Применяется фильтрация по диапазону HSV значений
3. **Морфологическая обработка**: Применяются операции открытия и закрытия для удаления шума
4. **Сглаживание**: Используется размытие Гауссом для сглаживания краев
5. **Визуализация**: Найденные тени накладываются на исходное изображение

## Структура проекта

```
prj.cw/
├── CMakeLists.txt          # Конфигурация сборки
├── build.sh               # Скрипт сборки (Linux/macOS)
├── build.bat              # Скрипт сборки (Windows)
├── src/                   # Исходный код
│   ├── main.cpp          # Точка входа
│   ├── mainwindow.cpp    # Главное окно
│   └── shadowledentifier.cpp # Алгоритм сегментации
├── include/               # Заголовочные файлы
│   ├── mainwindow.h
│   └── shadowledentifier.h
├── build/                 # Директория сборки (создается автоматически)
├── examples/              # Примеры изображений
└── README.md             # Данный файл
```

## Настройка параметров для различных условий

### Тени на асфальте:
- Hue: 0-30
- Saturation: 0-60
- Value: 0-80

### Тени на траве:
- Hue: 40-80
- Saturation: 30-150
- Value: 20-100

### Тени в помещении:
- Hue: 0-179
- Saturation: 0-80
- Value: 0-60

## Устранение неполадок

### Ошибки сборки:
1. Убедитесь, что все зависимости установлены
2. Проверьте версии CMake, OpenCV и Qt
3. Убедитесь, что переменные окружения настроены правильно

### Проблемы с детекцией:
1. Попробуйте различные значения HSV порогов
2. Учитывайте условия освещения на изображении
3. Для лучших результатов используйте изображения с хорошим контрастом

## Возможные улучшения

- Добавление автоматического определения оптимальных параметров
- Реализация более сложных алгоритмов сегментации теней
- Поддержка обработки видео
- Сохранение результатов в файл
- Предустановленные профили для различных типов изображений

## Лицензия

Данный проект создан в образовательных целях.
