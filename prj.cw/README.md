# Приложение для сегментации теней

Консольное приложение на C++ для автоматического обнаружения и сегментации теней на изображениях с использованием OpenCV.

## Требования

- Windows 10/11
- Visual Studio 2019/2022 с поддержкой C++
- CMake 3.10 или выше
- OpenCV 4.x
## Сборка

1. Убедитесь, что OpenCV установлен
2. Запустите build.bat
3. Исполняемый файл будет создан в build/Release/

## Использование

```bash
cd build/Release
ShadowSegmentation.exe путь_к_изображению.jpg
```

### Управление

- **ESC** или **Q** - выход из программы
- **S** - сохранить результат (shadow_result.jpg и shadow_mask.jpg)
- **R** - сбросить параметры к значениям по умолчанию

## Структура проекта

```
prj.cw/
├── CMakeLists.txt          # Конфигурация сборки
├── build.bat               # Скрипт сборки для Windows
├── README.md               # Документация
├── src/                    # Исходный код
│   ├── main.cpp            # Главный файл
│   └── shadowledentifier.cpp  # Алгоритм сегментации
├── include/                # Заголовочные файлы
│   └── shadowledentifier.h
├── build/                  # Директория сборки
└── examples/               # Примеры изображений
```

## Алгоритм

Приложение использует следующий алгоритм для обнаружения теней:

1. Сглаживание изображения (GaussianBlur) для уменьшения шума
2. Преобразование изображения в цветовые пространства LAB и HSV
3. Адаптивная пороговая фильтрация по каналам L (LAB) и V (HSV)
4. Исключение цветных областей по насыщенности (S-канал HSV)
5. Фильтрация по локальному контрасту (тени имеют низкий локальный контраст)
6. Фильтрация по цветовой однородности (разница между a и b каналами LAB)
7. Морфологические операции для удаления шума и заполнения дыр
8. Медианный фильтр для удаления точечного шума
9. Фильтрация по форме: тени обычно вытянутые, фильтруются по соотношению сторон
10. Наложение цветной маски на исходное изображение

Параметры фильтров и морфологии можно настраивать в коде.

## Примеры использования

```bash
# Обработка фотографии
ShadowSegmentation.exe photo.jpg

# Пакетная обработка всех изображений из папки examples
ShadowSegmentation.exe --batch
```
